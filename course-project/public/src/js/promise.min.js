window.setImmediate||function(){"use strict";var i=0,o={},u=!0,c=Array.prototype.slice,f="setImmediatePolyfillMessage";function a(n){var e,n=n.data;if("string"==typeof n&&0==n.indexOf(f)&&(e=o[n])){delete o[n];var t=e,r=t[0];switch(t.length){case 1:return void r();case 2:return void r(t[1]);case 3:return void r(t[1],t[2])}r.apply(window,c.call(t,1))}}window.setImmediate=function(){for(var n=i++,e=f+n,t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return o[e]=r,u&&(u=!1,window.addEventListener("message",a)),window.postMessage(e,"*"),n},window.clearImmediate=function(n){delete o[f+n]}}(),function(n){"use strict";var d="[[PromiseStatus]]",h="[[PromiseValue]]",w="[[OnFulfilled]]",m="[[OnRejected]]",a="[[OriginalError]]",i="pending",o="internal pending",p="fulfilled",v="rejected",s="not an array.",e='constructor Promise requires "new".',y=n.setImmediate||require("timers").setImmediate,l=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)};function u(n){this[a]=n}function g(n){return n instanceof u}function c(n){return"function"==typeof n}function P(n){return n instanceof A}function t(n){return n}function r(n){throw n}function f(n){delete n[w],delete n[m]}function j(n){for(var e=n.length,t=0;t<e;t++)n[t]()}function E(n,e,t){var r=I(t);P(r)?r.then(n,e):g(r)?e(r[a]):n(t)}function I(t){var r,n;if(P(t))return t;if(n=t,Object(n)===n){try{r=t.then}catch(n){return new u(n)}if(c(r))return new A(function(n,e){y(function(){try{r.call(t,n,e)}catch(n){e(n)}})})}return null}function O(e,n){function t(n){e[d]==i&&!function e(t,n){var r=I(n);P(r)?(t[d]=o,r.then(function(n){e(t,n)},function(n){b(t,n)})):g(r)?b(t,r[a]):(t[d]=p,t[h]=n,(r=t[w])&&r.length&&(f(t),j(r)))}(e,n)}function r(n){e[d]==i&&b(e,n)}try{n(t,r)}catch(n){r(n)}}function b(n,e){var t=n[m];n[d]=v,n[h]=e,t&&t.length&&(f(n),j(t))}function A(n){if(!P(this))throw new TypeError(e);this[d]=i,this[h]=void 0,O(this,n)}A.prototype.then=function(f,a){var s,l=this;return f=c(f)?f:t,a=c(a)?a:r,s=new A(function(t,r){function n(n){var e;try{e=n(l[h])}catch(n){return void r(n)}e===s?r(new TypeError("then() cannot return same Promise that it resolves.")):E(t,r,e)}function e(){y(n,f)}function i(){y(n,a)}switch(l[d]){case p:e();break;case v:i();break;default:u=e,c=i,(o=l)[w]||(o[w]=[],o[m]=[]),o[w].push(u),o[m].push(c)}var o,u,c})},A.prototype.catch=function(n){return this.then(t,n)},A.resolve=function(t){var r=I(t);return P(r)?r:new A(function(n,e){g(r)?e(r[a]):n(t)})},A.reject=function(t){return new A(function(n,e){e(t)})},A.race=function(i){return new A(function(n,e){var t,r;if(l(i))for(r=i.length,t=0;t<r;t++)E(n,e,i[t]);else e(new TypeError(s))})},A.all=function(f){return new A(function(t,n){var e,r,i,o,u=0,c=0;if(l(f)){for(r=(f=f.slice(0)).length,o=0;o<r;o++)P(e=I(i=f[o]))?(c++,e.then(function(e){return function(n){f[e]=n,++u==c&&t(f)}}(o),n)):g(e)?n(e[a]):f[o]=i;c||t(f)}else n(new TypeError(s))})},"undefined"!=typeof module&&module.exports?module.exports=n.Promise||A:n.Promise||(n.Promise=A)}(this);